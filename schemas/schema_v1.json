{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/Ensono/eirctl/internal/config/config-definition",
  "$ref": "#/$defs/ConfigDefinition",
  "$defs": {
    "Artifact": {
      "properties": {
        "name": {
          "type": "string"
        },
        "path": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": [
            "dotenv",
            "file",
            "env"
          ],
          "default": "dotenv"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "type"
      ]
    },
    "Binary": {
      "properties": {
        "bin": {
          "type": "string"
        },
        "args": {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "bin"
      ]
    },
    "ConfigDefinition": {
      "properties": {
        "import": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "import_files": {
          "items": {
            "$ref": "#/$defs/ImportFileDefinition"
          },
          "type": "array"
        },
        "contexts": {
          "additionalProperties": {
            "$ref": "#/$defs/ContextDefinition"
          },
          "type": "object"
        },
        "pipelines": {
          "additionalProperties": {
            "items": {
              "$ref": "#/$defs/PipelineDefinition"
            },
            "type": "array"
          },
          "type": "object"
        },
        "tasks": {
          "additionalProperties": {
            "$ref": "#/$defs/TaskDefinition"
          },
          "type": "object"
        },
        "watchers": {
          "additionalProperties": {
            "$ref": "#/$defs/WatcherDefinition"
          },
          "type": "object"
        },
        "debug": {
          "type": "boolean"
        },
        "dry_run": {
          "type": "boolean"
        },
        "summary": {
          "type": "boolean"
        },
        "verbose": {
          "type": "boolean"
        },
        "output": {
          "type": "string",
          "enum": [
            "raw",
            "cockpit",
            "prefixed"
          ]
        },
        "variables": {
          "$ref": "#/$defs/EnvVarMapType"
        },
        "ci_meta": {
          "$ref": "#/$defs/Generator"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "Container": {
      "properties": {
        "name": {
          "type": "string"
        },
        "entrypoint": {
          "$ref": "#/$defs/StringSlice",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array"
            }
          ]
        },
        "enable_dind": {
          "type": "boolean"
        },
        "enable_mount": {
          "type": "boolean"
        },
        "container_args": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "shell": {
          "type": "string"
        },
        "shell_args": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "pull_timeout": {
          "type": "integer",
          "default": 0
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name"
      ]
    },
    "ContextDefinition": {
      "properties": {
        "dir": {
          "type": "string"
        },
        "up": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "down": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "before": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "after": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "env": {
          "$ref": "#/$defs/EnvVarMapType"
        },
        "envfile": {
          "$ref": "#/$defs/Envfile"
        },
        "variables": {
          "$ref": "#/$defs/EnvVarMapType"
        },
        "executable": {
          "$ref": "#/$defs/Binary"
        },
        "quote": {
          "type": "string"
        },
        "container": {
          "$ref": "#/$defs/Container"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "EnvVarMapType": {
      "additionalProperties": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "type": "number"
          },
          {
            "type": "boolean"
          }
        ]
      },
      "type": "object"
    },
    "Envfile": {
      "properties": {
        "exclude": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "include": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "path": {
          "$ref": "#/$defs/StringSlice",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array"
            }
          ]
        },
        "replace_char": {
          "type": "string"
        },
        "quote": {
          "type": "boolean"
        },
        "modify": {
          "items": {
            "$ref": "#/$defs/ModifyEnv"
          },
          "type": "array"
        },
        "generated_dir": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "Generator": {
      "properties": {
        "version": {
          "type": "string"
        },
        "targetOpts": {
          "type": "object"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "ImportFileDefinition": {
      "properties": {
        "src": {
          "type": "string"
        },
        "dest": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "src"
      ]
    },
    "ModifyEnv": {
      "properties": {
        "pattern": {
          "type": "string"
        },
        "operation": {
          "type": "string",
          "enum": [
            "upper",
            "lower"
          ]
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "pattern",
        "operation"
      ]
    },
    "PipelineDefinition": {
      "oneOf": [
        {
          "required": [
            "task"
          ],
          "title": "task"
        },
        {
          "required": [
            "pipeline"
          ],
          "title": "pipeline"
        }
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "condition": {
          "type": "string"
        },
        "task": {
          "type": "string"
        },
        "pipeline": {
          "type": "string"
        },
        "depends_on": {
          "$ref": "#/$defs/StringSlice",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array"
            }
          ]
        },
        "allow_failure": {
          "type": "boolean"
        },
        "dir": {
          "type": "string"
        },
        "env": {
          "$ref": "#/$defs/EnvVarMapType"
        },
        "envfile": {
          "$ref": "#/$defs/Envfile"
        },
        "variables": {
          "$ref": "#/$defs/EnvVarMapType"
        },
        "ci_meta": {
          "type": "object"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "RequiredInput": {
      "properties": {
        "vars": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "env": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "args": {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "StringSlice": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      ]
    },
    "TaskDefinition": {
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "condition": {
          "type": "string"
        },
        "command": {
          "$ref": "#/$defs/StringSlice",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array"
            }
          ]
        },
        "after": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "before": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "context": {
          "type": "string"
        },
        "variations": {
          "items": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object"
          },
          "type": "array"
        },
        "dir": {
          "type": "string"
        },
        "timeout": {
          "type": "integer"
        },
        "allow_failure": {
          "type": "boolean"
        },
        "interactive": {
          "type": "boolean"
        },
        "artifacts": {
          "$ref": "#/$defs/Artifact"
        },
        "env": {
          "$ref": "#/$defs/EnvVarMapType"
        },
        "envfile": {
          "$ref": "#/$defs/Envfile"
        },
        "variables": {
          "$ref": "#/$defs/EnvVarMapType"
        },
        "reset_context": {
          "type": "boolean",
          "default": false
        },
        "ci_meta": {
          "type": "object"
        },
        "required": {
          "$ref": "#/$defs/RequiredInput"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "command"
      ]
    },
    "WatcherDefinition": {
      "properties": {
        "events": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "watch": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "exclude": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "task": {
          "type": "string"
        },
        "variables": {
          "additionalProperties": {
            "type": "string"
          },
          "type": "object"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "events",
        "watch",
        "task"
      ]
    }
  }
}